$javuApp.controller("dashboardCtrl",["$scope","$http",function(e,r){r.get("api/controlPanel/dashboard").success(function(r){e.stats=r.stats,e.stats.avg=Math.round(e.stats.total/e.stats.count,2),e.recentEvents=r.recentEvents})}]),define({init:function(){require(["uiManager"],function(e){var r=$("#frmForgetPassword:first");$("#btnSend:first").click(function(){return r[0].checkValidity()&&(e.showSpinner(),api.post("api/users/forgetPassword",{username:$("#txtEmail").val()},function(r){e.hideSpinner(),r?e.showAlert("warning",r.message):e.showAlert("success","Please check your email to reset your password")})),!1}),$("#btnBack:first").click(function(){require(["masterPageController"],function(e){e.load("login")})}),r.keypress(function(e){13==e.which&&(e.preventDefault(),$("#btnSend:first").trigger("click"))})})}}),$javuApp.controller("loginCtrl",["$scope","$http","uiManager","authManager",function(e,r,t,s){window.localStorage&&(e.userName=window.localStorage.getItem("rememberUserName")),e.submit=function(){s.login(e.username,e.password).success(function(){window.location.hash="/",e.rememberMe&&localStorage.setItem("rememberUserName",e.username)}).error(function(){})},e.forgotPassword=function(){window.location="/forgetPassword"}}]),$javuApp.controller("page1Ctrl",["$scope",function(){}]),define({init:function(){function e(){var e=$("#currentPassword:first")[0],r=$("#newPassword:first")[0],t=$("#confirmPassword:first")[0];return e.setCustomValidity(r.value&&!e.value?"Current Password is required.":""),t.setCustomValidity(r.value!=t.value?"Confirmation does not match.":""),$("#changePasswordForm:first")[0].checkValidity()}var r;require(["authManager"],function(e){return e.isUserLoggedIn()?(r=e.getCurrentUser(),$("#firstName:first").val(r.firstName),void $("#lastName:first").val(r.lastName)):void(window.location.hash="login")}),$("#saveButton:first").click(function(){return e()?(require(["uiManager"],function(e){e.showSpinner("saving",2e3),r.firstName=$("#firstName:first").val(),r.lastName=$("#lastName:first").val();var t=$("#currentPassword:first").val(),s=$("#newPassword:first").val();api.post("api/users/user/update",{user:r},function(r,n){if(r)return e.showAlert("warning",r.message),void e.hideSpinner();var a=function(r,t){e.hideSpinner(),e.showAlert("success","Your profile has been saved"),require(["authManager"],function(e){e.setCurrentUser(t)})};s&&s!=t?api.post("api/users/changePassword",{currentPassword:t,newPassword:s.value},a):a(null,n)})}),!1):void 0})}}),define(["uiManager"],function(e){return{init:function(){e.hideSidebar().hideTopMenu();var r=$("#frmRegistrationForm:first")[0];$("#btnRegister:first").click(function(){var t=$("#txtEmail:first").val(),s=$("#txtPassword:first"),n=s.val(),a=$("#txtConfirm:first");return a[0].setCustomValidity(n!=a.val()?"Password doesn't match":""),r.checkValidity()?(api.post("/api/register",{email:t,password:n,firstName:$("#txtFirstName:first").val(),lastName:$("#txtLastName:first").val()},function(r){return r?("duplicateUsername"==r.code?e.showAlert("danger",r.message):e.showAlert("danger","An error occurred while attempting to register your account. Please try again latter"),!1):void require(["authManager"],function(e){e.login(t,n,function(e){e&&require(["uiManager"],function(r){r.showAlert("warning",e.message)})})})}),!1):void 0})}}}),define({init:function(){require(["uiManager","masterPageController"],function(e,r){var t=null,s=null;t=r.getParameterByName("tempAuthKey"),e.showSpinner(),api.get("api/users/tempAuthKey",{tempAuthKey:t},function(r,t){e.hideSpinner(),r?showAlert("warning",r.message):($("#bodyContainer").removeClass("hidden"),s=t.userToken,$("#userEmail").html(t.email))}),$("input").keypress(function(e){13==e.which&&(e.preventDefault(),$("#btnResetPassword:first").trigger("click"))}),$("#btnResetPassword:first").click(function(){$("#frmResetPassword:first")[0].triggerValidationUI()&&(e.showSpinner(),api.post("api/users/resetPassword",{tempAuthKey:t,userToken:s,password:$("#txtPassword").val()},function(r,t){e.hideSpinner(),r?showAlert("warning",r.message):require(["authManager"],function(e){e.setCurrentUser(t),$("#bodyContainer").addClass("hidden");var r=getParameterByName("redirectPage");showAlert("success","Password has been reset successfully, we will redirect you in 5 sec."),(null==r||""==r)&&(r="/index.html"),setTimeout(function(){window.location=r},5e3)})}))})})}});